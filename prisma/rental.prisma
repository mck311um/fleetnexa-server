model Rental {
  id                String             @id @default(dbgenerated("gen_random_uuid()"))
  rentalNumber      String?
  startDate         DateTime
  endDate           DateTime
  pickupLocationId  String
  returnLocationId  String
  vehicleId         String
  originalVehicleId String?
  vehicleSwapped    Boolean            @default(false)
  agent             Agent
  createdAt         DateTime           @default(now())
  updatedAt         DateTime?          @updatedAt
  tenantId          String
  status            RentalStatus       @default(PENDING)
  createdBy         String?
  updatedBy         String?
  notes             String?
  isDeleted         Boolean            @default(false)
  chargeTypeId      String?
  bookingCode       String?            @unique
  deletedAt         DateTime?
  invoice           Invoice?
  payments          Payment[]
  refunds           Refund[]
  chargeType        ChargeType?        @relation(fields: [chargeTypeId], references: [id])
  user              User?              @relation(fields: [createdBy], references: [id])
  pickup            TenantLocation     @relation("PickupLocation", fields: [pickupLocationId], references: [id])
  return            TenantLocation     @relation("ReturnLocation", fields: [returnLocationId], references: [id])
  tenant            Tenant             @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  vehicle           Vehicle            @relation(fields: [vehicleId], references: [id])
  rentalActivity    RentalActivity[]
  agreement         RentalAgreement?
  charges           RentalCharge[]
  drivers           RentalDriver[]
  storefrontBooking StorefrontBooking?
  transactions      Transactions[]
  values            Values?
  vessels           VesselInfo[]
  vehicleHistory    BookingVehicleHistory[]
  paymentReceipts   PaymentReceipt[]
}

model StorefrontBooking {
  id        String         @id @default(dbgenerated("gen_random_uuid()"))
  rentalId  String         @unique
  userId    String
  createdAt DateTime       @default(now())
  updatedAt DateTime?      @updatedAt
  rental    Rental         @relation(fields: [rentalId], references: [id])
  user      StorefrontUser @relation(fields: [userId], references: [id])
}

model RentalDriver {
  id        String   @id @default(dbgenerated("gen_random_uuid()"))
  rentalId  String
  driverId  String
  isPrimary Boolean  @default(false)
  customer  Customer @relation(fields: [driverId], references: [id])
  rental    Rental   @relation(fields: [rentalId], references: [id])

  @@unique([rentalId, driverId], name: "rentalId_driverId")
}

model Values {
  id                   String        @id @default(dbgenerated("gen_random_uuid()"))
  numberOfDays         Int
  basePrice            Float
  totalCost            Float
  discount             Float
  deliveryFee          Float
  collectionFee        Float
  deposit              Float
  totalExtras          Float
  subTotal             Float         @default(0.0)
  netTotal             Float         @default(0.0)
  amountDue            Float         @default(0.0)
  rentalId             String        @unique
  discountAmount       Float
  discountPolicy       String
  createdAt            DateTime      @default(now())
  updatedAt            DateTime?     @updatedAt
  additionalDriverFees Float         @default(0.0)
  cancellationFee      Float         @default(0.0)
  lateFee              Float         @default(0.0)
  customBasePrice      Boolean       @default(false)
  customCollectionFee  Boolean       @default(false)
  customDeliveryFee    Boolean       @default(false)
  customDeposit        Boolean       @default(false)
  customDiscount       Boolean       @default(false)
  customTotalCost      Boolean       @default(false)
  extras               RentalExtra[]
  rental               Rental        @relation(fields: [rentalId], references: [id])
}

model RentalExtra {
  id           String  @id @default(dbgenerated("gen_random_uuid()"))
  extraId      String
  amount       Float
  valuesId     String
  customAmount Boolean @default(false)
  values       Values  @relation(fields: [valuesId], references: [id])
}

model RentalCharge {
  id         String   @id @default(dbgenerated("gen_random_uuid()"))
  rentalId   String
  charge     String
  reason     String?
  amount     Float
  customerId String
  tenantId   String
  createdAt  DateTime @default(now())
  customer   Customer @relation(fields: [customerId], references: [id])
  rental     Rental   @relation(fields: [rentalId], references: [id])
  tenant     Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
}

model VesselInfo {
  id        String        @id @default(dbgenerated("gen_random_uuid()"))
  bookingId String
  portId    String
  direction DirectionType
  type      VesselType
  carrier   String
  number    String
  arrival   DateTime?
  departure DateTime?
  notes     String?
  booking   Rental        @relation(fields: [bookingId], references: [id])
  port      Port          @relation(fields: [portId], references: [id])
}

